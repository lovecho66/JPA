# 12장_스프링 데이터 JPA

<b>✨설명 전 Point 잡고 가기✨</b> 

jpa 편하게 사용하는게 스프링 jpa다. 

```java
 public Optional<Member> findById(Long id) {
   Member member = em.find(Member.class, id);
   return Optional.ofNullable(member);
 }

```
- 반환값이 null일 수 있다. Optional 타입을 한번 감싸서 내보내는거다.
-java 8
- 기본적으로 알쟈
- 반복적인 코드를 인터페이스로 해결
- 스프링 jpa가 알아서 구현체를 만들어서 인젝션해주는거다.
- 로딩시점에 스프링관련된 인터페이스가 있으면 구현체를 만들어버림
- sping data jpa가 JpaRepository를 extends 상속받을 것을 보고 구현체를 만들어서 주입(인젝션)시킨다.
- 인터페이스 레포지토리는 @Repository안해줘도된다.
- 인터페이스만 잡으면 스프링 데이터 jpa가  구현클래스를 만들어서 인젝션한다.

- 중요) 엔티티,엔티티에 매핍된 pk의 타입이다.
- jpa를 편하게 쓸 수 있게 구현코드를 작성할 필요없이 인터페이스만 선언해서 사용하기만 하면된다.
- 구현체 없고 인터페이스만 있다.
- jpa에 특화된 기술이 있는 jpaRepository를 상속 받는다.
- 유사한 인터페이스로 편하게 개발하기 좋다.~
- 구현하지않아도 스프링 데이터 jpa가 쿼리메소드 기능으로 쿼리를 만들지 않아도 구현해준다.

- 공통 메소드가 아니라 내가 따로 구현한 쿼리를 만들고 싶으면 쿼리 메소드 기능을 사용하면 된다. 
- 쿼리 메소드 기능
  - 메소드 이름만 봐도 아는데 우리가 구현해줘야하나..
  - 구현체 안만들고 메소드 이름만 형식에 맞춰서 인터페이스에 구현했더니 실행된다.
  - 스프링 데이터 jpa가 제공하는 아주 강력한 기능인 메소드 이름으로 만들어준다.
  - 이름을 꼭 맞춰줘야한다. 관례에 맞게 구현되야 한다.
  - 맞지 않으면 이름이 맞지 않다는 오류가 난다.
  - 어떤 기능이 되는지는 jpa 메뉴얼을 봐야한다. spring data jpa를 보자!
  - 이름이 너무 길어지면..특히 2개 이상..다른 방법으로 jpql을 직접짜서 한다.
  - 쿼리 메소드 이름을 가지고 원하는 데이터를 뽑아 올 수 있다.
 
 - 엔티티의 필드명을 바꾸면 실행시점에 오류가 나는걸 잡을 수 있다. (애플리케이션 로딩시점에)

 - -----
 JPA NamedQuery는 실무에 쓸 일이 없어서 편하게 보쟈!
 - jpa는 namedQuery를 제공한다.
 - 엔티티에다가 @namedquery를 준다.
 - 재활용이 가능하다. 계속 같은 쿼리를 쓸 수 있다.
 - 구현하는게 귀찮아서.. jpa에서 사용안한다. 그러나 스프링 데이터 jpa에서는 이 구현을 편리하게 하는 방법을 제공한다.
 - @Query어노테이션을 사용하는거다.  @Param도 적어줘야 한다.
 - 명확하게 jpql이 적혀 있을때 @Param이 필요하다.
 - 스프링 데이터 jpa가 @Query 가 없어도 관례로 인해서 실행을 시켜준다. 먼저 namedBy부터 찾고 공통 메소드를 찾는거다. 없으면 메소드 이름으로 찾는다.
 - 이 기능은 실무에서 거의 사용안한다~~ 엔티티에 있는것도 맘에 안들고 따로 빼도 맘에 안들고 왔다갔다가 도싫고 스프링 데이터 jpa가 레포지토리에다가 바로 쿼리를 지정할 수 있는 막강한 기능이 있어서 named는 별루..
 - 바로 jpql을 칠 수 있는데 뭐하로~
 - 레포지토리에 쿼리 정의가 막강하다!
 - 그래도 namedquery의 막강한 장점이 하나가 있다 오타가 있으면 애플리케이션 로딩시점에 파싱을 시켜서 문법 오류를 알려준다. 정적쿼리기때문에 애플리케이션 로딩시점에 파싱을 해볼 수 있다.
 - "" 문자열은 파싱이 안되서 문법이 틀린지 맞는지 잘모르고 사용자가 실행할때 오류가난다...윽
